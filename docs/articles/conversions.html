<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Conversions to and from the incidence class • incidence</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Conversions to and from the incidence class">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">incidence</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/conversions.html">Conversions to and from the incidence class</a>
    </li>
    <li>
      <a href="../articles/customize_plot.html">Customize plots of incidence</a>
    </li>
    <li>
      <a href="../articles/incidence_class.html">Details of the incidence class</a>
    </li>
    <li>
      <a href="../articles/overview.html">Overview of the incidence package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Conversions to and from the incidence class</h1>
                        <h4 class="author">Thibaut Jombart</h4>
            
            <h4 class="date">2018-07-06</h4>
      
      
      <div class="hidden name"><code>conversions.Rmd</code></div>

    </div>

    
    
<p>This vignette documents to types of conversion which can be made using the <em>incidence</em> class:</p>
<ul>
<li><p><em>‘exports’</em>: conversion from an <em>incidence</em> object to another type of object; this can be useful for processing incidence data in another software, or for reporting results.</p></li>
<li><p><em>‘imports’</em>conversion from already computed incidence into an <em>incidence</em> object; this can be useful for using features of the <em>incidence</em> package for data handling and plotting with incidence data computed elsewhere.</p></li>
</ul>
<p><br></p>
<div id="exporting-results" class="section level1">
<h1 class="hasAnchor">
<a href="#exporting-results" class="anchor"></a>Exporting results</h1>
<p>To export results, we first compute bi-weekly incidence by gender from the simulated Ebola data used in the <a href="http://www.repidemicsconsortium.org/incidence/articles/overview.html">overview vignette</a>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(outbreaks)
<span class="kw">library</span>(incidence)
dat &lt;-<span class="st"> </span>ebola_sim$linelist$date_of_onset
i_14 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/incidence.html">incidence</a></span>(dat, <span class="dt">interval =</span> <span class="dv">14</span>, <span class="dt">groups =</span> ebola_sim$linelist$gender)
i_14
<span class="co">#&gt; &lt;incidence object&gt;</span>
<span class="co">#&gt; [5888 cases from days 2014-04-07 to 2015-04-20]</span>
<span class="co">#&gt; [2 groups: f, m]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $counts: matrix with 28 rows and 2 columns</span>
<span class="co">#&gt; $n: 5888 cases in total</span>
<span class="co">#&gt; $dates: 28 dates marking the left-side of bins</span>
<span class="co">#&gt; $interval: 14 days</span>
<span class="co">#&gt; $timespan: 379 days</span>
<span class="co">#&gt; $cumulative: FALSE</span>
<span class="kw">plot</span>(i_14, <span class="dt">border =</span> <span class="st">"white"</span>)</code></pre></div>
<p><img src="figs-conversion/example-1.png" width="672"></p>
<p>To export the data to a <code>data.frame</code>, one simply needs:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as.data.frame</span>(i_14)
<span class="co">#&gt;         dates   f   m</span>
<span class="co">#&gt; 1  2014-04-07   1   1</span>
<span class="co">#&gt; 2  2014-04-21   8   1</span>
<span class="co">#&gt; 3  2014-05-05  17  13</span>
<span class="co">#&gt; 4  2014-05-19  17  18</span>
<span class="co">#&gt; 5  2014-06-02  20  25</span>
<span class="co">#&gt; 6  2014-06-16  27  25</span>
<span class="co">#&gt; 7  2014-06-30  29  44</span>
<span class="co">#&gt; 8  2014-07-14  73  48</span>
<span class="co">#&gt; 9  2014-07-28  90  79</span>
<span class="co">#&gt; 10 2014-08-11 122 139</span>
<span class="co">#&gt; 11 2014-08-25 189 184</span>
<span class="co">#&gt; 12 2014-09-08 290 278</span>
<span class="co">#&gt; 13 2014-09-22 316 286</span>
<span class="co">#&gt; 14 2014-10-06 270 272</span>
<span class="co">#&gt; 15 2014-10-20 246 273</span>
<span class="co">#&gt; 16 2014-11-03 202 195</span>
<span class="co">#&gt; 17 2014-11-17 154 161</span>
<span class="co">#&gt; 18 2014-12-01 136 150</span>
<span class="co">#&gt; 19 2014-12-15 124 115</span>
<span class="co">#&gt; 20 2014-12-29  88 108</span>
<span class="co">#&gt; 21 2015-01-12 112  95</span>
<span class="co">#&gt; 22 2015-01-26  86  82</span>
<span class="co">#&gt; 23 2015-02-09  76  73</span>
<span class="co">#&gt; 24 2015-02-23  76  75</span>
<span class="co">#&gt; 25 2015-03-09  57  71</span>
<span class="co">#&gt; 26 2015-03-23  63  42</span>
<span class="co">#&gt; 27 2015-04-06  45  42</span>
<span class="co">#&gt; 28 2015-04-20  28  31</span></code></pre></div>
<p>The first column contains the dates marking the (inclusive) left side of the time intervals used for computing incidence, and the other columns give counts for the different groups. This function also has an option for exporting data as a ‘long’ format, i.e. with a column for ‘groups’ and a column for counts. This format can be useful especially when working with <em>ggplot2</em>, which expect data in this shape:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(i_14, <span class="dt">long =</span> <span class="ot">TRUE</span>)
<span class="kw">head</span>(df)
<span class="co">#&gt;        dates counts groups</span>
<span class="co">#&gt; 1 2014-04-07      1      f</span>
<span class="co">#&gt; 2 2014-04-21      8      f</span>
<span class="co">#&gt; 3 2014-05-05     17      f</span>
<span class="co">#&gt; 4 2014-05-19     17      f</span>
<span class="co">#&gt; 5 2014-06-02     20      f</span>
<span class="co">#&gt; 6 2014-06-16     27      f</span>
<span class="kw">tail</span>(df)
<span class="co">#&gt;         dates counts groups</span>
<span class="co">#&gt; 51 2015-02-09     73      m</span>
<span class="co">#&gt; 52 2015-02-23     75      m</span>
<span class="co">#&gt; 53 2015-03-09     71      m</span>
<span class="co">#&gt; 54 2015-03-23     42      m</span>
<span class="co">#&gt; 55 2015-04-06     42      m</span>
<span class="co">#&gt; 56 2015-04-20     31      m</span>

## example of custom plot using steps:
<span class="kw">library</span>(ggplot2)
<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(df, <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> dates, <span class="dt">y =</span> counts)) +<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_path">geom_step</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">color =</span> groups))</code></pre></div>
<p><img src="figs-conversion/long-1.png" width="672"></p>
<p>Finally, note that when ISO weeks are used, these are also reported in the output:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">i_7 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/incidence.html">incidence</a></span>(dat, <span class="dt">interval =</span> <span class="dv">7</span>)
i_7
<span class="co">#&gt; &lt;incidence object&gt;</span>
<span class="co">#&gt; [5888 cases from days 2014-04-07 to 2015-04-27]</span>
<span class="co">#&gt; [5888 cases from ISO weeks 2014-W15 to 2015-W18]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $counts: matrix with 56 rows and 1 columns</span>
<span class="co">#&gt; $n: 5888 cases in total</span>
<span class="co">#&gt; $dates: 56 dates marking the left-side of bins</span>
<span class="co">#&gt; $interval: 7 days</span>
<span class="co">#&gt; $timespan: 386 days</span>
<span class="co">#&gt; $cumulative: FALSE</span>
<span class="kw">plot</span>(i_7, <span class="dt">border =</span> <span class="st">"white"</span>)</code></pre></div>
<p><img src="figs-conversion/iso-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">as.data.frame</span>(i_7))
<span class="co">#&gt;        dates isoweeks counts</span>
<span class="co">#&gt; 1 2014-04-07 2014-W15      1</span>
<span class="co">#&gt; 2 2014-04-14 2014-W16      1</span>
<span class="co">#&gt; 3 2014-04-21 2014-W17      5</span>
<span class="co">#&gt; 4 2014-04-28 2014-W18      4</span>
<span class="co">#&gt; 5 2014-05-05 2014-W19     12</span>
<span class="co">#&gt; 6 2014-05-12 2014-W20     18</span>
<span class="kw">tail</span>(<span class="kw">as.data.frame</span>(i_7))
<span class="co">#&gt;         dates isoweeks counts</span>
<span class="co">#&gt; 51 2015-03-23 2015-W13     51</span>
<span class="co">#&gt; 52 2015-03-30 2015-W14     54</span>
<span class="co">#&gt; 53 2015-04-06 2015-W15     42</span>
<span class="co">#&gt; 54 2015-04-13 2015-W16     45</span>
<span class="co">#&gt; 55 2015-04-20 2015-W17     40</span>
<span class="co">#&gt; 56 2015-04-27 2015-W18     19</span></code></pre></div>
<p><br></p>
</div>
<div id="importing-pre-computed-incidence" class="section level1">
<h1 class="hasAnchor">
<a href="#importing-pre-computed-incidence" class="anchor"></a>Importing pre-computed incidence</h1>
<p>The function <code>as.incidence</code> facilitates the conversion of pre-computed incidences to an <em>incidence</em> object. Typically, the input will be imported into R from a <em>.csv</em> file or other spreadsheet formats.</p>
<p><code>as.incidence</code> is a generic with methods for several types of objects (see <code><a href="../reference/conversions.html">?as.incidence</a></code>). The main method is <code>matrix</code>, as other types are coerced to <code>matrix</code> first and then passed to <code>as.incidence.matrix</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(incidence:::as.incidence.matrix)
<span class="co">#&gt; function (x, dates = NULL, interval = NULL, isoweeks = TRUE, </span>
<span class="co">#&gt;     ...) </span>
<span class="co">#&gt; NULL</span></code></pre></div>
<p>The only mandatory argument <code>x</code> is a table of counts, with time intervals in rows and groups in columns; if there are no groups, then the column doesn’t need a name; but if there are several groups, then columns should be named to indicate group labels. Optionally, <code>dates</code> can be provided to indicate the (inclusive) lower bounds of the time intervals, corresponding to the rows of <code>x</code>; most sensible date formats will do; if indicated as a character string, make sure the format is <code>YYYY-mm-dd</code>, e.g. <code>2017-04-01</code> for the 1st April 2017.</p>
<p>Let us illustrate the conversion using a simple vector of incidence:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>)

i &lt;-<span class="st"> </span><span class="kw"><a href="../reference/conversions.html">as.incidence</a></span>(vec)
i
<span class="co">#&gt; &lt;incidence object&gt;</span>
<span class="co">#&gt; [19 cases from days 1 to 10]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $counts: matrix with 10 rows and 1 columns</span>
<span class="co">#&gt; $n: 19 cases in total</span>
<span class="co">#&gt; $dates: 10 dates marking the left-side of bins</span>
<span class="co">#&gt; $interval: 1 day</span>
<span class="co">#&gt; $timespan: 10 days</span>
<span class="co">#&gt; $cumulative: FALSE</span>

<span class="kw">plot</span>(vec, <span class="dt">type =</span> <span class="st">"s"</span>)</code></pre></div>
<p><img src="figs-conversion/unnamed-chunk-3-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(i, <span class="dt">border =</span> <span class="st">"white"</span>)</code></pre></div>
<p><img src="figs-conversion/unnamed-chunk-3-2.png" width="672"></p>
<p>Assuming the above incidences are computed weekly, we would then use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">i &lt;-<span class="st"> </span><span class="kw"><a href="../reference/conversions.html">as.incidence</a></span>(vec, <span class="dt">interval =</span> <span class="dv">7</span>)
i
<span class="co">#&gt; &lt;incidence object&gt;</span>
<span class="co">#&gt; [19 cases from days 1 to 64]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $counts: matrix with 10 rows and 1 columns</span>
<span class="co">#&gt; $n: 19 cases in total</span>
<span class="co">#&gt; $dates: 10 dates marking the left-side of bins</span>
<span class="co">#&gt; $interval: 7 days</span>
<span class="co">#&gt; $timespan: 64 days</span>
<span class="co">#&gt; $cumulative: FALSE</span>
<span class="kw">plot</span>(i, <span class="dt">border =</span> <span class="st">"white"</span>)</code></pre></div>
<p><img src="figs-conversion/unnamed-chunk-4-1.png" width="672"></p>
<p>Note that in this case, incidences have been treated as per week, and corresponding dates in days have been computed during the conversion (the first day is always ‘1’), so that the first days of weeks 1, 2, 3… are:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">i$dates
<span class="co">#&gt;  [1]  1  8 15 22 29 36 43 50 57 64</span></code></pre></div>
<p>In practice, it is best to provide the actual dates marking the lower bounds of the time intervals. We can illustrate this by a round trip using the example of the previous section:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## convertion: incidence --&gt; data.frame:
i_14
<span class="co">#&gt; &lt;incidence object&gt;</span>
<span class="co">#&gt; [5888 cases from days 2014-04-07 to 2015-04-20]</span>
<span class="co">#&gt; [2 groups: f, m]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $counts: matrix with 28 rows and 2 columns</span>
<span class="co">#&gt; $n: 5888 cases in total</span>
<span class="co">#&gt; $dates: 28 dates marking the left-side of bins</span>
<span class="co">#&gt; $interval: 14 days</span>
<span class="co">#&gt; $timespan: 379 days</span>
<span class="co">#&gt; $cumulative: FALSE</span>
df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(i_14)
<span class="kw">head</span>(df)
<span class="co">#&gt;        dates  f  m</span>
<span class="co">#&gt; 1 2014-04-07  1  1</span>
<span class="co">#&gt; 2 2014-04-21  8  1</span>
<span class="co">#&gt; 3 2014-05-05 17 13</span>
<span class="co">#&gt; 4 2014-05-19 17 18</span>
<span class="co">#&gt; 5 2014-06-02 20 25</span>
<span class="co">#&gt; 6 2014-06-16 27 25</span>
<span class="kw">tail</span>(df)
<span class="co">#&gt;         dates  f  m</span>
<span class="co">#&gt; 23 2015-02-09 76 73</span>
<span class="co">#&gt; 24 2015-02-23 76 75</span>
<span class="co">#&gt; 25 2015-03-09 57 71</span>
<span class="co">#&gt; 26 2015-03-23 63 42</span>
<span class="co">#&gt; 27 2015-04-06 45 42</span>
<span class="co">#&gt; 28 2015-04-20 28 31</span>

## conversion: data.frame --&gt; incidence
new_i &lt;-<span class="st"> </span><span class="kw"><a href="../reference/conversions.html">as.incidence</a></span>(df[,-<span class="dv">1</span>], df$dates)
new_i
<span class="co">#&gt; &lt;incidence object&gt;</span>
<span class="co">#&gt; [5888 cases from days 2014-04-07 to 2015-04-20]</span>
<span class="co">#&gt; [2 groups: f, m]</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $counts: matrix with 28 rows and 2 columns</span>
<span class="co">#&gt; $n: 5888 cases in total</span>
<span class="co">#&gt; $dates: 28 dates marking the left-side of bins</span>
<span class="co">#&gt; $interval: 14 days</span>
<span class="co">#&gt; $timespan: 379 days</span>
<span class="co">#&gt; $cumulative: FALSE</span>

## check round trip
<span class="kw">identical</span>(new_i, i_14)
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#exporting-results">Exporting results</a></li>
      <li><a href="#importing-pre-computed-incidence">Importing pre-computed incidence</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Thibaut Jombart, Rich FitzJohn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
